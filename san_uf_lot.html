<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Registro de Aplicaciones</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      margin: 0;
    }
    /*header {
      background: #f1042f;
      color: white;
      padding: 1rem;
      display: flex;
      align-items: center;
    }*/
    header img {
      height: 50px;
      margin-right: 15px;
    }
    main {
      display: flex;
      padding: 2rem;
      gap: 2rem;
      flex-wrap: wrap;
    }
    svg {
      width: 400px;
      height: auto;
      background: #fff;
      border: 1px solid #ccc;
      cursor: pointer;
    }
    path {
      stroke: #444;
      stroke-width: 1;
      fill: #ddd;
      transition: fill 0.2s;
    }
    path:hover {
      fill: #bbb;
    }
    form {
      background: #fff;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      flex: 1;
      min-width: 300px;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 1rem;
    }
    input, select, button {
      width: 100%;
      padding: 0.6rem;
      margin-top: 0.5rem;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      background: #f1042f;
      color: white;
      font-weight: bold;
      margin-top: 1.5rem;
      cursor: pointer;
    }
    button:hover {
      background: #004d00;
    }
   /* main {
      display: flex;
      padding: 2rem;
      gap: 2rem;
      flex-wrap: wrap;
    }
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      box-sizing: border-box;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    h2 {
      text-align: center;
      color: #333;
    }
    
    #map-container {
      position: relative;
      width: 100%;
      overflow: auto;
      margin-bottom: 20px;
      border: 1px solid #ccc;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    svg {
      width: 400px;
      height: auto;
      background: #fff;
      border: 1px solid #ccc;
      cursor: pointer;
    }
    
    .area {
      transition: all 0.3s ease;
      opacity: 0.7;
    }
    
    .area:hover {
      opacity: 1;
      stroke: #333;
      stroke-width: 1px;
    }
    
    .selected {
      stroke: #333 !important;
      stroke-width: 2px !important;
      opacity: 1 !important;
    }
    
    .tooltip {
      position: absolute;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 14px;
      pointer-events: none;
      display: none;
      z-index: 100;
    }
    
    .form-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .form-group {
      flex: 1;
      min-width: 200px;
    }
    
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #555;
    }
    
    select, input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
    }
    
    /* Estilo para select múltiple */
    select[multiple] {
      height: auto;
      min-height: 100px;
    }
    
    #color-picker {
      width: 50px;
      height: 38px;
      padding: 0;
      border: 1px solid #ddd;
    }
    
    button {
      background-color: #f1042f;
      color: white;
      border: none;
      padding: 10px 20px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 10px 0;
      cursor: pointer;
      border-radius: 4px;
      transition: background-color 0.3s;
    }
    
    button:hover {
      background-color:#f16f04;
    }
    
    button:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
    }
    
    #selected-areas {
      margin-top: 15px;
      padding: 10px;
      background: #f5f5f5;
      border-radius: 4px;
    }
    
    #selected-list {
      list-style-type: none;
      padding: 0;
    }
    
    #selected-list li {
      padding: 5px 0;
      border-bottom: 1px solid #ddd;
      display: flex;
      justify-content: space-between;
    }
    
    .remove-area {
      color: red;
      cursor: pointer;
      margin-left: 10px;
    }
    
    @media (max-width: 768px) {
      .form-group {
        min-width: 100%;
      }
      
      #map-container {
        overflow-x: auto;
      }
    }
/*
    header img {
      width: 80px;
      height: auto;
      margin-bottom: 10px;
    }

    header h1 {
      margin: 5px 0;
      font-size: 32px; /* Más grande */
      /*font-weight: bold;
    }*/
/*
    header h3 {
      margin: 0;
      font-size: 16px; /* Más pequeño */
 /*     font-weight: normal;
  /*    opacity: 0.85; /* Un poco más tenue */
  /*  }*/
/*
    header img {
  width: 60px; 
  height: auto;
  margin-right: 1rem;
}

.header-text {
  display: flex;
  flex-direction: column;
}

.header-text h1 {
  margin: 0;
  font-size: 1.8rem;
}

.header-text h3 {
  margin: 0;
  font-size: 1rem; 
  font-weight: normal;
}*/
/*aaaa*/

header {
      background: #f1042f;
      color: white;
      padding: 1rem;
      display: grid;
      grid-template-columns: auto 1fr;
      align-items: center;
      gap: 1rem;
    }

    header img {
      width: 60px;
      height: auto;
    }

    .header-text h1 {
      margin: 0;
      font-size: 1.8rem;
    }

    .header-text h3 {
      margin: 0;
      font-size: 1rem;
      font-weight: normal;
    }

  </style>
</head>
<body>

<header>
    <img src="logouf.png" alt="Logo">
    <div class="header-text">
      <h1>Registro de Aplicaciones Agrícolas</h1>
      <h3>Fundo Bomarea</h3>
    </div>
  </header>
<main>
<div id="map-container">
  <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 814 1242" fill="none">
<rect x="330" y="1184" width="73" height="20" fill="#D9D9D9" id="M01T07L31" class="area" title="M01T07L31"/>
<rect x="255" y="1184" width="73" height="20" fill="#D9D9D9" id="M01T05L21" class="area" title="M01T05L21"/>
<rect x="176" y="1184" width="73" height="20" fill="#D9D9D9" id="M01T03L11" class="area" title="M01T03L11"/>
<rect x="101" y="1184" width="73" height="20" fill="#D9D9D9" id="M01T01L01" class="area" title="M01T01L01"/>
<rect x="101" y="1162" width="73" height="20" fill="#D9D9D9" id="M01T01L02" class="area" title="M01T01L02"/>
<rect x="101" y="1140" width="73" height="20" fill="#D9D9D9" id="M01T01L03" class="area" title="M01T01L03"/>
<rect x="101" y="1118" width="73" height="20" fill="#D9D9D9" id="M01T01L04" class="area" title="M01T01L04"/>
<rect x="101" y="1096" width="73" height="20" fill="#D9D9D9" id="M01T01L05" class="area" title="M01T01L05"/>
<rect x="330" y="1096" width="73" height="20" fill="#D9D9D9" id="M01T07L35" class="area" title="M01T07L35"/>
<rect x="255" y="1096" width="73" height="20" fill="#D9D9D9" id="M01T05L25" class="area" title="M01T05L25"/>
<rect x="330" y="1118" width="73" height="20" fill="#D9D9D9" id="M01T07L34" class="area" title="M01T07L34"/>
<rect x="255" y="1118" width="73" height="20" fill="#D9D9D9" id="M01T05L24" class="area" title="M01T05L24"/>
<rect x="330" y="1140" width="73" height="20" fill="#D9D9D9" id="M01T07L33" class="area" title="M01T07L33"/>
<rect x="255" y="1140" width="73" height="20" fill="#D9D9D9" id="M01T05L23" class="area" title="M01T05L23"/>
<rect x="330" y="1162" width="73" height="20" fill="#D9D9D9" id="M01T07L32" class="area" title="M01T07L32"/>
<rect x="255" y="1162" width="73" height="20" fill="#D9D9D9" id="M01T05L22" class="area" title="M01T05L22"/>
<rect x="176" y="1096" width="73" height="20" fill="#D9D9D9" id="M01T03L15" class="area" title="M01T03L15"/>
<rect x="176" y="1118" width="73" height="20" fill="#D9D9D9" id="M01T03L14" class="area" title="M01T03L14"/>
<rect x="176" y="1140" width="73" height="20" fill="#D9D9D9" id="M01T03L13" class="area" title="M01T03L13"/>
<rect x="176" y="1162" width="73" height="20" fill="#D9D9D9" id="M01T03L12" class="area" title="M01T03L12"/>
<rect x="330" y="1071" width="73" height="20" fill="#D9D9D9" id="M01T08L36" class="area" title="M01T08L36"/>
<rect x="255" y="1071" width="73" height="20" fill="#D9D9D9" id="M01T06L26" class="area" title="M01T06L26"/>
<rect x="176" y="1071" width="73" height="20" fill="#D9D9D9" id="M01T04L16" class="area" title="M01T04L16"/>
<rect x="101" y="1071" width="73" height="20" fill="#D9D9D9" id="M01T02L06" class="area" title="M01T02L06"/>
<rect x="330" y="983" width="73" height="20" fill="#D9D9D9" id="M01T08L40" class="area" title="M01T08L40"/>
<rect x="255" y="983" width="73" height="20" fill="#D9D9D9" id="M01T06L30" class="area" title="M01T06L30"/>
<rect x="330" y="1005" width="73" height="20" fill="#D9D9D9" id="M01T08L39" class="area" title="M01T08L39"/>
<rect x="255" y="1005" width="73" height="20" fill="#D9D9D9" id="M01T06L29" class="area" title="M01T06L29"/>
<rect x="330" y="1027" width="73" height="20" fill="#D9D9D9" id="M01T08L38" class="area" title="M01T08L38"/>
<rect x="255" y="1027" width="73" height="20" fill="#D9D9D9" id="M01T06L28" class="area" title="M01T06L28"/>
<rect x="330" y="1049" width="73" height="20" fill="#D9D9D9" id="M01T08L37" class="area" title="M01T08L37"/>
<rect x="255" y="1049" width="73" height="20" fill="#D9D9D9" id="M01T06L27" class="area" title="M01T06L27"/>
<rect x="176" y="983" width="73" height="20" fill="#D9D9D9" id="M01T04L20" class="area" title="M01T04L20"/>
<rect x="101" y="983" width="73" height="20" fill="#D9D9D9" id="M01T02L10" class="area" title="M01T02L10"/>
<rect x="176" y="1005" width="73" height="20" fill="#D9D9D9" id="M01T04L19" class="area" title="M01T04L19"/>
<rect x="101" y="1005" width="73" height="20" fill="#D9D9D9" id="M01T02L09" class="area" title="M01T02L09"/>
<rect x="176" y="1027" width="73" height="20" fill="#D9D9D9" id="M01T04L18" class="area" title="M01T04L18"/>
<rect x="101" y="1027" width="73" height="20" fill="#D9D9D9" id="M01T02L08" class="area" title="M01T02L08"/>
<rect x="176" y="1049" width="73" height="20" fill="#D9D9D9" id="M01T04L17" class="area" title="M01T04L17"/>
<rect x="101" y="1049" width="73" height="20" fill="#D9D9D9" id="M01T02L07" class="area" title="M01T02L07"/>
<rect x="640" y="180" width="73" height="20" fill="#D9D9D9" id="M10T03L27" class="area" title="M10T03L27"/>
<rect x="565" y="180" width="73" height="20" fill="#D9D9D9" id="M10T03L19" class="area" title="M10T03L19"/>
<rect x="640" y="202" width="73" height="20" fill="#D9D9D9" id="M10T03L26" class="area" title="M10T03L26"/>
<rect x="565" y="202" width="73" height="20" fill="#D9D9D9" id="M10T03L18" class="area" title="M10T03L18"/>
<rect x="640" y="224" width="73" height="20" fill="#D9D9D9" id="M10T03L25" class="area" title="M10T03L25"/>
<rect x="565" y="224" width="73" height="20" fill="#D9D9D9" id="M10T03L17" class="area" title="M10T03L17"/>
<rect x="565" y="246" width="36" height="20" fill="#D9D9D9" id="M10T05L34" class="area" title="M10T05L34"/>
<rect x="602" y="246" width="36" height="20" fill="#D9D9D9" id="M10T05L36" class="area" title="M10T05L36"/>
<rect x="640" y="246" width="36" height="20" fill="#D9D9D9" id="M10T05L38" class="area" title="M10T05L38"/>
<rect x="677" y="246" width="36" height="20" fill="#D9D9D9" id="M10T05L40" class="area" title="M10T05L40"/>
<rect x="565" y="268" width="36" height="20" fill="#D9D9D9" id="M10T05L33" class="area" title="M10T05L33"/>
<rect x="602" y="268" width="36" height="20" fill="#D9D9D9" id="M10T05L35" class="area" title="M10T05L35"/>
<rect x="640" y="268" width="36" height="20" fill="#D9D9D9" id="M10T05L37" class="area" title="M10T05L37"/>
<rect x="677" y="268" width="36" height="20" fill="#D9D9D9" id="M10T05L39" class="area" title="M10T05L39"/>
<rect x="486" y="180" width="73" height="20" fill="#D9D9D9" id="M10T01L11" class="area" title="M10T01L11"/>
<rect x="411" y="180" width="73" height="20" fill="#D9D9D9" id="M10T01L03" class="area" title="M10T01L03"/>
<rect x="486" y="202" width="73" height="20" fill="#D9D9D9" id="M10T01L10" class="area" title="M10T01L10"/>
<rect x="411" y="202" width="73" height="20" fill="#D9D9D9" id="M10T01L02" class="area" title="M10T01L02"/>
<rect x="486" y="224" width="73" height="20" fill="#D9D9D9" id="M10T01L09" class="area" title="M10T01L09"/>
<rect x="411" y="224" width="73" height="20" fill="#D9D9D9" id="M10T01L01" class="area" title="M10T01L01"/>
<rect x="640" y="155" width="73" height="20" fill="#D9D9D9" id="M10T03L28" class="area" title="M10T03L28"/>
<rect x="565" y="155" width="73" height="20" fill="#D9D9D9" id="M10T03L20" class="area" title="M10T03L20"/>
<rect x="486" y="155" width="73" height="20" fill="#D9D9D9" id="M10T01L12" class="area" title="M10T01L12"/>
<rect x="411" y="155" width="73" height="20" fill="#D9D9D9" id="M10T01L04" class="area" title="M10T01L04"/>
<rect x="640" y="67" width="73" height="20" fill="#D9D9D9" id="M10T04L32" class="area" title="M10T04L32"/>
<rect x="565" y="67" width="73" height="20" fill="#D9D9D9" id="M10T04L24" class="area" title="M10T04L24"/>
<rect x="640" y="89" width="73" height="20" fill="#D9D9D9" id="M10T04L31" class="area" title="M10T04L31"/>
<rect x="565" y="89" width="73" height="20" fill="#D9D9D9" id="M10T04L23" class="area" title="M10T04L23"/>
<rect x="640" y="111" width="73" height="20" fill="#D9D9D9" id="M10T04L30" class="area" title="M10T04L30"/>
<rect x="565" y="111" width="73" height="20" fill="#D9D9D9" id="M10T04L22" class="area" title="M10T04L22"/>
<rect x="640" y="133" width="73" height="20" fill="#D9D9D9" id="M10T04L29" class="area" title="M10T04L29"/>
<rect x="565" y="133" width="73" height="20" fill="#D9D9D9" id="M10T04L21" class="area" title="M10T04L21"/>
<rect x="486" y="67" width="73" height="20" fill="#D9D9D9" id="M10T02L16" class="area" title="M10T02L16"/>
<rect x="411" y="67" width="73" height="20" fill="#D9D9D9" id="M10T02L08" class="area" title="M10T02L08"/>
<rect x="486" y="89" width="73" height="20" fill="#D9D9D9" id="M10T02L15" class="area" title="M10T02L15"/>
<rect x="411" y="89" width="73" height="20" fill="#D9D9D9" id="M10T02L07" class="area" title="M10T02L07"/>
<rect x="486" y="111" width="73" height="20" fill="#D9D9D9" id="M10T02L14" class="area" title="M10T02L14"/>
<rect x="411" y="111" width="73" height="20" fill="#D9D9D9" id="M10T02L06" class="area" title="M10T02L06"/>
<rect x="486" y="133" width="73" height="20" fill="#D9D9D9" id="M10T02L13" class="area" title="M10T02L13"/>
<rect x="411" y="133" width="73" height="20" fill="#D9D9D9" id="M10T02L05" class="area" title="M10T02L05"/>
<rect x="330" y="38" width="73" height="20" fill="#D9D9D9" id="M09T06L29" class="area" title="M09T06L29"/>
<rect x="255" y="38" width="73" height="20" fill="#D9D9D9" id="M09T06L28" class="area" title="M09T06L28"/>
<rect x="101" y="198" width="73" height="20" fill="#D9D9D9" id="M09T01L04" class="area" title="M09T01L04"/>
<rect x="101" y="220" width="64" height="20" fill="#D9D9D9" id="M09T01L03" class="area" title="M09T01L03"/>
<rect x="101" y="242" width="61" height="20" fill="#D9D9D9" id="M09T01L02" class="area" title="M09T01L02"/>
<rect x="101" y="264" width="58" height="20" fill="#D9D9D9" id="M09T01L01" class="area" title="M09T01L01"/>
<rect x="101" y="176" width="73" height="20" fill="#D9D9D9" id="M09T01L05" class="area" title="M09T01L05"/>
<rect x="176" y="38" width="73" height="20" fill="#D9D9D9" id="M09T06L27" class="area" title="M09T06L27"/>
<rect x="101" y="38" width="73" height="20" fill="#D9D9D9" id="M09T06L26" class="area" title="M09T06L26"/>
<rect x="330" y="151" width="73" height="20" fill="#D9D9D9" id="M09T05L21" class="area" title="M09T05L21"/>
<rect x="255" y="151" width="73" height="20" fill="#D9D9D9" id="M09T04L16" class="area" title="M09T04L16"/>
<rect x="176" y="151" width="73" height="20" fill="#D9D9D9" id="M09T03L11" class="area" title="M09T03L11"/>
<rect x="101" y="151" width="73" height="20" fill="#D9D9D9" id="M09T02L06" class="area" title="M09T02L06"/>
<rect x="330" y="63" width="73" height="20" fill="#D9D9D9" id="M09T05L25" class="area" title="M09T05L25"/>
<rect x="255" y="63" width="73" height="20" fill="#D9D9D9" id="M09T04L20" class="area" title="M09T04L20"/>
<rect x="330" y="85" width="73" height="20" fill="#D9D9D9" id="M09T05L24" class="area" title="M09T05L24"/>
<rect x="255" y="85" width="73" height="20" fill="#D9D9D9" id="M09T04L19" class="area" title="M09T04L19"/>
<rect x="330" y="107" width="73" height="20" fill="#D9D9D9" id="M09T05L23" class="area" title="M09T05L23"/>
<rect x="255" y="107" width="73" height="20" fill="#D9D9D9" id="M09T04L18" class="area" title="M09T04L18"/>
<rect x="330" y="129" width="73" height="20" fill="#D9D9D9" id="M09T05L22" class="area" title="M09T05L22"/>
<rect x="255" y="129" width="73" height="20" fill="#D9D9D9" id="M09T04L17" class="area" title="M09T04L17"/>
<rect x="176" y="63" width="73" height="20" fill="#D9D9D9" id="M09T03L15" class="area" title="M09T03L15"/>
<rect x="101" y="63" width="73" height="20" fill="#D9D9D9" id="M09T02L10" class="area" title="M09T02L10"/>
<rect x="176" y="85" width="73" height="20" fill="#D9D9D9" id="M09T03L14" class="area" title="M09T03L14"/>
<rect x="101" y="85" width="73" height="20" fill="#D9D9D9" id="M09T02L09" class="area" title="M09T02L09"/>
<rect x="176" y="107" width="73" height="20" fill="#D9D9D9" id="M09T03L13" class="area" title="M09T03L13"/>
<rect x="101" y="107" width="73" height="20" fill="#D9D9D9" id="M09T02L08" class="area" title="M09T02L08"/>
<rect x="176" y="129" width="73" height="20" fill="#D9D9D9" id="M09T03L12" class="area" title="M09T03L12"/>
<rect x="101" y="129" width="73" height="20" fill="#D9D9D9" id="M09T02L07" class="area" title="M09T02L07"/>
<rect x="330" y="955" width="73" height="20" fill="#D9D9D9" id="M03T07L31" class="area" title="M03T07L31"/>
<rect x="255" y="955" width="73" height="20" fill="#D9D9D9" id="M03T05L21" class="area" title="M03T05L21"/>
<rect x="176" y="955" width="73" height="20" fill="#D9D9D9" id="M03T03L11" class="area" title="M03T03L11"/>
<rect x="101" y="955" width="73" height="20" fill="#D9D9D9" id="M03T01L01" class="area" title="M03T01L01"/>
<rect x="330" y="867" width="73" height="20" fill="#D9D9D9" id="M03T07L35" class="area" title="M03T07L35"/>
<rect x="255" y="867" width="73" height="20" fill="#D9D9D9" id="M03T05L25" class="area" title="M03T05L25"/>
<rect x="330" y="889" width="73" height="20" fill="#D9D9D9" id="M03T07L34" class="area" title="M03T07L34"/>
<rect x="255" y="889" width="73" height="20" fill="#D9D9D9" id="M03T05L24" class="area" title="M03T05L24"/>
<rect x="330" y="911" width="73" height="20" fill="#D9D9D9" id="M03T07L33" class="area" title="M03T07L33"/>
<rect x="255" y="911" width="73" height="20" fill="#D9D9D9" id="M03T05L23" class="area" title="M03T05L23"/>
<rect x="330" y="933" width="73" height="20" fill="#D9D9D9" id="M03T07L32" class="area" title="M03T07L32"/>
<rect x="255" y="933" width="73" height="20" fill="#D9D9D9" id="M03T05L22" class="area" title="M03T05L22"/>
<rect x="176" y="867" width="73" height="20" fill="#D9D9D9" id="M03T03L15" class="area" title="M03T03L15"/>
<rect x="101" y="867" width="73" height="20" fill="#D9D9D9" id="M03T01L05" class="area" title="M03T01L05"/>
<rect x="176" y="889" width="73" height="20" fill="#D9D9D9" id="M03T03L14" class="area" title="M03T03L14"/>
<rect x="101" y="889" width="73" height="20" fill="#D9D9D9" id="M03T01L04" class="area" title="M03T01L04"/>
<rect x="176" y="911" width="73" height="20" fill="#D9D9D9" id="M03T03L13" class="area" title="M03T03L13"/>
<rect x="101" y="911" width="73" height="20" fill="#D9D9D9" id="M03T01L03" class="area" title="M03T01L03"/>
<rect x="176" y="933" width="73" height="20" fill="#D9D9D9" id="M03T03L12" class="area" title="M03T03L12"/>
<rect x="101" y="933" width="73" height="20" fill="#D9D9D9" id="M03T01L02" class="area" title="M03T01L02"/>
<rect x="330" y="842" width="73" height="20" fill="#D9D9D9" id="M03T08L36" class="area" title="M03T08L36"/>
<rect x="255" y="842" width="73" height="20" fill="#D9D9D9" id="M03T06L26" class="area" title="M03T06L26"/>
<rect x="176" y="842" width="73" height="20" fill="#D9D9D9" id="M03T04L16" class="area" title="M03T04L16"/>
<rect x="101" y="842" width="73" height="20" fill="#D9D9D9" id="M03T02L06" class="area" title="M03T02L06"/>
<rect x="330" y="754" width="73" height="20" fill="#D9D9D9" id="M03T08L40" class="area" title="M03T08L40"/>
<rect x="255" y="754" width="73" height="20" fill="#D9D9D9" id="M03T06L30" class="area" title="M03T06L30"/>
<rect x="330" y="776" width="73" height="20" fill="#D9D9D9" id="M03T08L39" class="area" title="M03T08L39"/>
<rect x="255" y="776" width="73" height="20" fill="#D9D9D9" id="M03T06L29" class="area" title="M03T06L29"/>
<rect x="330" y="798" width="73" height="20" fill="#D9D9D9" id="M03T08L38" class="area" title="M03T08L38"/>
<rect x="255" y="798" width="73" height="20" fill="#D9D9D9" id="M03T06L28" class="area" title="M03T06L28"/>
<rect x="330" y="820" width="73" height="20" fill="#D9D9D9" id="M03T08L37" class="area" title="M03T08L37"/>
<rect x="255" y="820" width="73" height="20" fill="#D9D9D9" id="M03T06L27" class="area" title="M03T06L27"/>
<rect x="176" y="754" width="73" height="20" fill="#D9D9D9" id="M03T04L20" class="area" title="M03T04L20"/>
<rect x="101" y="754" width="73" height="20" fill="#D9D9D9" id="M03T02L10" class="area" title="M03T02L10"/>
<rect x="176" y="776" width="73" height="20" fill="#D9D9D9" id="M03T04L19" class="area" title="M03T04L19"/>
<rect x="101" y="776" width="73" height="20" fill="#D9D9D9" id="M03T02L09" class="area" title="M03T02L08"/>
<rect x="176" y="798" width="73" height="20" fill="#D9D9D9" id="M03T04L18" class="area" title="M03T04L18"/>
<rect x="101" y="798" width="73" height="20" fill="#D9D9D9" id="M03T02L08" class="area" title="M03T02L08"/>
<rect x="176" y="820" width="73" height="20" fill="#D9D9D9" id="M03T04L17" class="area" title="M03T04L17"/>
<rect x="101" y="820" width="73" height="20" fill="#D9D9D9" id="M03T02L07" class="area" title="M03T02L07"/>
<rect x="101" y="726" width="48" height="20" fill="#D9D9D9" id="M05T01L01" class="area" title="M05T01L01"/>
<rect x="151" y="726" width="49" height="20" fill="#D9D9D9" id="M05T01L11" class="area" title="M05T01L11"/>
<rect x="202" y="726" width="47" height="20" fill="#D9D9D9" id="M05T03L21" class="area" title="M05T03L21"/>
<rect x="101" y="704" width="48" height="20" fill="#D9D9D9" id="M05T01L02" class="area" title="M05T01L02"/>
<rect x="151" y="704" width="49" height="20" fill="#D9D9D9" id="M05T01L12" class="area" title="M05T01L12"/>
<rect x="202" y="704" width="47" height="20" fill="#D9D9D9" id="M05T03L22" class="area" title="M05T03L22"/>
<rect x="101" y="682" width="48" height="20" fill="#D9D9D9" id="M05T01L03" class="area" title="M05T01L03"/>
<rect x="151" y="682" width="49" height="20" fill="#D9D9D9" id="M05T01L13" class="area" title="M05T01L13"/>
<rect x="202" y="682" width="47" height="20" fill="#D9D9D9" id="M05T03L23" class="area" title="M05T03L23"/>
<rect x="101" y="660" width="48" height="20" fill="#D9D9D9" id="M05T01L04" class="area" title="M05T01L04"/>
<rect x="151" y="660" width="49" height="20" fill="#D9D9D9" id="M05T01L14" class="area" title="M05T01L14"/>
<rect x="202" y="660" width="47" height="20" fill="#D9D9D9" id="M05T03L24" class="area" title="M05T03L24"/>
<rect x="101" y="638" width="48" height="20" fill="#D9D9D9" id="M05T01L05" class="area" title="M05T01L05"/>
<rect x="151" y="638" width="49" height="20" fill="#D9D9D9" id="M05T01L15" class="area" title="M05T01L15"/>
<rect x="202" y="638" width="47" height="20" fill="#D9D9D9" id="M05T03L25" class="area" title="M05T03L25"/>
<rect x="255" y="726" width="48" height="20" fill="#D9D9D9" id="M05T03L31" class="area" title="M05T03L31"/>
<rect x="305" y="726" width="49" height="20" fill="#D9D9D9" id="M05T05L41" class="area" title="M05T05L41"/>
<rect x="356" y="726" width="47" height="20" fill="#D9D9D9" id="M05T05L51" class="area" title="M05T05L51"/>
<rect x="255" y="704" width="48" height="20" fill="#D9D9D9" id="M05T03L32" class="area" title="M05T03L32"/>
<rect x="305" y="704" width="49" height="20" fill="#D9D9D9" id="M05T05L42" class="area" title="M05T05L42"/>
<rect x="356" y="704" width="47" height="20" fill="#D9D9D9" id="M05T05L52" class="area" title="M05T05L52"/>
<rect x="255" y="682" width="48" height="20" fill="#D9D9D9" id="M05T03L33" class="area" title="M05T03L33"/>
<rect x="305" y="682" width="49" height="20" fill="#D9D9D9" id="M05T05L43" class="area" title="M05T05L43"/>
<rect x="356" y="682" width="47" height="20" fill="#D9D9D9" id="M05T05L53" class="area" title="M05T05L53"/>
<rect x="255" y="660" width="48" height="20" fill="#D9D9D9" id="M05T03L34" class="area" title="M05T03L34"/>
<rect x="305" y="660" width="49" height="20" fill="#D9D9D9" id="M05T05L44" class="area" title="M05T05L44"/>
<rect x="356" y="660" width="47" height="20" fill="#D9D9D9" id="M05T05L54" class="area" title="M05T05L54"/>
<rect x="255" y="638" width="48" height="20" fill="#D9D9D9" id="M05T03L35" class="area" title="M05T03L35"/>
<rect x="305" y="638" width="49" height="20" fill="#D9D9D9" id="M05T05L45" class="area" title="M05T05L45"/>
<rect x="356" y="638" width="47" height="20" fill="#D9D9D9" id="M05T05L55" class="area" title="M05T05L55"/>
<rect x="101" y="613" width="48" height="20" fill="#D9D9D9" id="M05T02L06" class="area" title="M05T02L06"/>
<rect x="151" y="613" width="49" height="20" fill="#D9D9D9" id="M05T02L16" class="area" title="M05T02L16"/>
<rect x="202" y="613" width="47" height="20" fill="#D9D9D9" id="M05T04L26" class="area" title="M05T04L26"/>
<rect x="101" y="591" width="48" height="20" fill="#D9D9D9" id="M05T02L07" class="area" title="M05T02L07"/>
<rect x="151" y="591" width="49" height="20" fill="#D9D9D9" id="M05T02L17" class="area" title="M05T02L17"/>
<rect x="202" y="591" width="47" height="20" fill="#D9D9D9" id="M05T04L27" class="area" title="M05T04L27"/>
<rect x="101" y="569" width="48" height="20" fill="#D9D9D9" id="M05T02L08" class="area" title="M05T02L08"/>
<rect x="151" y="569" width="49" height="20" fill="#D9D9D9" id="M05T02L18" class="area" title="M05T02L18"/>
<rect x="202" y="569" width="47" height="20" fill="#D9D9D9" id="M05T04L28" class="area" title="M05T04L28"/>
<rect x="101" y="547" width="48" height="20" fill="#D9D9D9" id="M05T02L09" class="area" title="M05T02L09"/>
<rect x="151" y="547" width="49" height="20" fill="#D9D9D9" id="M05T02L19" class="area" title="M05T02L19"/>
<rect x="202" y="547" width="47" height="20" fill="#D9D9D9" id="M05T04L29" class="area" title="M05T04L29"/>
<rect x="101" y="525" width="48" height="20" fill="#D9D9D9" id="M05T02L10" class="area" title="M05T02L10"/>
<rect x="151" y="525" width="49" height="20" fill="#D9D9D9" id="M05T02L20" class="area" title="M05T02L20"/>
<rect x="202" y="525" width="47" height="20" fill="#D9D9D9" id="M05T04L30" class="area" title="M05T04L30"/>
<rect x="255" y="613" width="48" height="20" fill="#D9D9D9" id="M05T04L36" class="area" title="M05T04L36"/>
<rect x="305" y="613" width="49" height="20" fill="#D9D9D9" id="M05T06L46" class="area" title="M05T06L46"/>
<rect x="356" y="613" width="47" height="20" fill="#D9D9D9" id="M05T06L56" class="area" title="M05T06L56"/>
<rect x="255" y="591" width="48" height="20" fill="#D9D9D9" id="M05T04L37" class="area" title="M05T04L37"/>
<rect x="305" y="591" width="49" height="20" fill="#D9D9D9" id="M05T06L47" class="area" title="M05T06L47"/>
<rect x="356" y="591" width="47" height="20" fill="#D9D9D9" id="M05T06L57" class="area" title="M05T06L57"/>
<rect x="255" y="569" width="48" height="20" fill="#D9D9D9" id="M05T04L38" class="area" title="M05T04L38"/>
<rect x="305" y="569" width="49" height="20" fill="#D9D9D9" id="M05T06L48" class="area" title="M05T06L48"/>
<rect x="356" y="569" width="47" height="20" fill="#D9D9D9" id="M05T06L58" class="area" title="M05T06L58"/>
<rect x="255" y="547" width="48" height="20" fill="#D9D9D9" id="M05T04L39" class="area" title="M05T04L39"/>
<rect x="305" y="547" width="49" height="20" fill="#D9D9D9" id="M05T06L49" class="area" title="M05T06L49"/>
<rect x="356" y="547" width="47" height="20" fill="#D9D9D9" id="M05T06L59" class="area" title="M05T06L59"/>
<rect x="255" y="525" width="48" height="20" fill="#D9D9D9" id="M05T04L40" class="area" title="M05T04L40"/>
<rect x="305" y="525" width="49" height="20" fill="#D9D9D9" id="M05T06L50" class="area" title="M05T06L50"/>
<rect x="356" y="525" width="47" height="20" fill="#D9D9D9" id="M05T06L60" class="area" title="M05T06L60"/>
<rect x="101" y="497" width="48" height="20" fill="#D9D9D9" id="M07T01L01" class="area" title="M07T01L01"/>
<rect x="151" y="497" width="49" height="20" fill="#D9D9D9" id="M07T01L11" class="area" title="M07T01L11"/>
<rect x="202" y="497" width="47" height="20" fill="#D9D9D9" id="M07T03L21" class="area" title="M07T03L21"/>
<rect x="101" y="475" width="48" height="20" fill="#D9D9D9" id="M07T01L02" class="area" title="M07T01L02"/>
<rect x="151" y="475" width="49" height="20" fill="#D9D9D9" id="M07T01L12" class="area" title="M07T01L12"/>
<rect x="202" y="475" width="47" height="20" fill="#D9D9D9" id="M07T03L22" class="area" title="M07T03L22"/>
<rect x="101" y="453" width="48" height="20" fill="#D9D9D9" id="M07T01L03" class="area" title="M07T01L03"/>
<rect x="151" y="453" width="49" height="20" fill="#D9D9D9" id="M07T01L13" class="area" title="M07T01L13"/>
<rect x="202" y="453" width="47" height="20" fill="#D9D9D9" id="M07T03L23" class="area" title="M07T03L23"/>
<rect x="101" y="431" width="48" height="20" fill="#D9D9D9" id="M07T01L04" class="area" title="M07T01L04"/>
<rect x="151" y="431" width="49" height="20" fill="#D9D9D9" id="M07T01L14" class="area" title="M07T01L14"/>
<rect x="202" y="431" width="47" height="20" fill="#D9D9D9" id="M07T03L24" class="area" title="M07T03L24"/>
<rect x="101" y="409" width="48" height="20" fill="#D9D9D9" id="M07T01L05" class="area" title="M07T01L05"/>
<rect x="151" y="409" width="49" height="20" fill="#D9D9D9" id="M07T01L15" class="area" title="M07T01L15"/>
<rect x="202" y="409" width="47" height="20" fill="#D9D9D9" id="M07T03L25" class="area" title="M07T03L25"/>
<rect x="255" y="497" width="48" height="20" fill="#D9D9D9" id="M07T03L31" class="area" title="M07T03L31"/>
<rect x="305" y="497" width="49" height="20" fill="#D9D9D9" id="M07T05L41" class="area" title="M07T05L41"/>
<rect x="356" y="497" width="47" height="20" fill="#D9D9D9" id="M07T05L51" class="area" title="M07T05L51"/>
<rect x="255" y="475" width="48" height="20" fill="#D9D9D9" id="M07T03L32" class="area" title="M07T03L32"/>
<rect x="305" y="475" width="49" height="20" fill="#D9D9D9" id="M07T05L42" class="area" title="M07T05L42"/>
<rect x="356" y="475" width="47" height="20" fill="#D9D9D9" id="M07T05L52" class="area" title="M07T05L52"/>
<rect x="255" y="453" width="48" height="20" fill="#D9D9D9" id="M07T03L33" class="area" title="M07T03L33"/>
<rect x="305" y="453" width="49" height="20" fill="#D9D9D9" id="M07T05L43" class="area" title="M07T05L43"/>
<rect x="356" y="453" width="47" height="20" fill="#D9D9D9" id="M07T05L53" class="area" title="M07T05L53"/>
<rect x="255" y="431" width="48" height="20" fill="#D9D9D9" id="M07T03L34" class="area" title="M07T03L34"/>
<rect x="305" y="431" width="49" height="20" fill="#D9D9D9" id="M07T05L44" class="area" title="M07T05L44"/>
<rect x="356" y="431" width="47" height="20" fill="#D9D9D9" id="M07T05L54" class="area" title="M07T05L54"/>
<rect x="255" y="409" width="48" height="20" fill="#D9D9D9" id="M07T03L35" class="area" title="M07T03L35"/>
<rect x="305" y="409" width="49" height="20" fill="#D9D9D9" id="M07T05L45" class="area" title="M07T05L45"/>
<rect x="356" y="409" width="47" height="20" fill="#D9D9D9" id="M07T05L55" class="area" title="M07T05L55"/>
<rect x="101" y="384" width="48" height="20" fill="#D9D9D9" id="M07T02L06" class="area" title="M07T02L06"/>
<rect x="151" y="384" width="49" height="20" fill="#D9D9D9" id="M07T02L16" class="area" title="M07T02L16"/>
<rect x="202" y="384" width="47" height="20" fill="#D9D9D9" id="M07T04L26" class="area" title="M07T04L26"/>
<rect x="101" y="362" width="48" height="20" fill="#D9D9D9" id="M07T02L07" class="area" title="M07T02L07"/>
<rect x="151" y="362" width="49" height="20" fill="#D9D9D9" id="M07T02L17" class="area" title="M07T02L17"/>
<rect x="202" y="362" width="47" height="20" fill="#D9D9D9" id="M07T04L27" class="area" title="M07T04L27"/>
<rect x="101" y="340" width="48" height="20" fill="#D9D9D9" id="M07T02L08" class="area" title="M07T02L08"/>
<rect x="151" y="340" width="49" height="20" fill="#D9D9D9" id="M07T02L18" class="area" title="M07T02L18"/>
<rect x="202" y="340" width="47" height="20" fill="#D9D9D9" id="M07T04L28" class="area" title="M07T04L28"/>
<rect x="101" y="318" width="48" height="20" fill="#D9D9D9" id="M07T02L09" class="area" title="M07T02L09"/>
<rect x="151" y="318" width="49" height="20" fill="#D9D9D9" id="M07T02L19" class="area" title="M07T02L19"/>
<rect x="202" y="318" width="47" height="20" fill="#D9D9D9" id="M07T04L29" class="area" title="M07T04L29"/>
<rect x="101" y="296" width="48" height="20" fill="#D9D9D9" id="M07T02L10" class="area" title="M07T02L10"/>
<rect x="151" y="296" width="49" height="20" fill="#D9D9D9" id="M07T02L20" class="area" title="M07T02L20"/>
<rect x="202" y="296" width="47" height="20" fill="#D9D9D9" id="M07T04L30" class="area" title="M07T04L30"/>
<rect x="255" y="384" width="48" height="20" fill="#D9D9D9" id="M07T04L36" class="area" title="M07T04L36"/>
<rect x="305" y="384" width="49" height="20" fill="#D9D9D9" id="M07T06L46" class="area" title="M07T06L46"/>
<rect x="356" y="384" width="47" height="20" fill="#D9D9D9" id="M07T06L56" class="area" title="M07T06L56"/>
<rect x="255" y="362" width="48" height="20" fill="#D9D9D9" id="M07T04L37" class="area" title="M07T04L37"/>
<rect x="305" y="362" width="49" height="20" fill="#D9D9D9" id="M07T06L47" class="area" title="M07T06L47"/>
<rect x="356" y="362" width="47" height="20" fill="#D9D9D9" id="M07T06L57" class="area" title="M07T06L57"/>
<rect x="255" y="340" width="48" height="20" fill="#D9D9D9" id="M07T04L38" class="area" title="M07T04L38"/>
<rect x="305" y="340" width="49" height="20" fill="#D9D9D9" id="M07T06L48" class="area" title="M07T06L48"/>
<rect x="356" y="340" width="47" height="20" fill="#D9D9D9" id="M07T06L58" class="area" title="M07T06L58"/>
<rect x="255" y="318" width="48" height="20" fill="#D9D9D9" id="M07T04L39" class="area" title="M07T04L39"/>
<rect x="305" y="318" width="49" height="20" fill="#D9D9D9" id="M07T06L49" class="area" title="M07T06L49"/>
<rect x="356" y="318" width="47" height="20" fill="#D9D9D9" id="M07T06L59" class="area" title="M07T06L59"/>
<rect x="255" y="296" width="48" height="20" fill="#D9D9D9" id="M07T04L40" class="area" title="M07T04L40"/>
<rect x="305" y="296" width="49" height="20" fill="#D9D9D9" id="M07T06L50" class="area" title="M07T06L50"/>
<rect x="356" y="296" width="47" height="20" fill="#D9D9D9" id="M07T06L60" class="area" title="M07T06L60"/>
<rect x="411" y="497" width="48" height="20" fill="#D9D9D9" id="M08T01L01" class="area" title="M08T01L01"/>
<rect x="461" y="497" width="49" height="20" fill="#D9D9D9" id="M08T01L11" class="area" title="M08T01L11"/>
<rect x="512" y="497" width="47" height="20" fill="#D9D9D9" id="M08T03L21" class="area" title="M08T03L21"/>
<rect x="411" y="475" width="48" height="20" fill="#D9D9D9" id="M08T01L02" class="area" title="M08T01L02"/>
<rect x="461" y="475" width="49" height="20" fill="#D9D9D9" id="M08T01L12" class="area" title="M08T01L12"/>
<rect x="512" y="475" width="47" height="20" fill="#D9D9D9" id="M08T03L22" class="area" title="M08T03L22"/>
<rect x="411" y="453" width="48" height="20" fill="#D9D9D9" id="M08T01L03" class="area" title="M08T01L03"/>
<rect x="461" y="453" width="49" height="20" fill="#D9D9D9" id="M08T01L13" class="area" title="M08T01L13"/>
<rect x="512" y="453" width="47" height="20" fill="#D9D9D9" id="M08T03L23" class="area" title="M08T03L23"/>
<rect x="411" y="431" width="48" height="20" fill="#D9D9D9" id="M08T01L04" class="area" title="M08T01L04"/>
<rect x="461" y="431" width="49" height="20" fill="#D9D9D9" id="M08T01L14" class="area" title="M08T01L14"/>
<rect x="512" y="431" width="47" height="20" fill="#D9D9D9" id="M08T03L24" class="area" title="M08T03L24"/>
<rect x="411" y="409" width="48" height="20" fill="#D9D9D9" id="M08T01L05" class="area" title="M08T01L05"/>
<rect x="461" y="409" width="49" height="20" fill="#D9D9D9" id="M08T01L15" class="area" title="M08T01L15"/>
<rect x="512" y="409" width="47" height="20" fill="#D9D9D9" id="M08T03L25" class="area" title="M08T03L25"/>
<rect x="565" y="497" width="48" height="20" fill="#D9D9D9" id="M08T03L31" class="area" title="M08T03L31"/>
<rect x="615" y="497" width="49" height="20" fill="#D9D9D9" id="M08T05L41" class="area" title="M08T05L41"/>
<rect x="666" y="497" width="47" height="20" fill="#D9D9D9" id="M08T05L51" class="area" title="M08T05L51"/>
<rect x="565" y="475" width="48" height="20" fill="#D9D9D9" id="M08T03L32" class="area" title="M08T03L32"/>
<rect x="615" y="475" width="49" height="20" fill="#D9D9D9" id="M08T05L42" class="area" title="M08T05L42"/>
<rect x="666" y="475" width="47" height="20" fill="#D9D9D9" id="M08T05L52" class="area" title="M08T05L52"/>
<rect x="565" y="453" width="48" height="20" fill="#D9D9D9" id="M08T03L33" class="area" title="M08T03L33"/>
<rect x="615" y="453" width="49" height="20" fill="#D9D9D9" id="M08T05L43" class="area" title="M08T05L43"/>
<rect x="666" y="453" width="47" height="20" fill="#D9D9D9" id="M08T05L53" class="area" title="M08T05L53"/>
<rect x="565" y="431" width="48" height="20" fill="#D9D9D9" id="M08T03L34" class="area" title="M08T03L34"/>
<rect x="615" y="431" width="49" height="20" fill="#D9D9D9" id="M08T05L44" class="area" title="M08T05L44"/>
<rect x="666" y="431" width="47" height="20" fill="#D9D9D9" id="M08T05L54" class="area" title="M08T05L54"/>
<rect x="565" y="409" width="48" height="20" fill="#D9D9D9" id="M08T03L35" class="area" title="M08T03L35"/>
<rect x="615" y="409" width="49" height="20" fill="#D9D9D9" id="M08T05L45" class="area" title="M08T05L45"/>
<rect x="666" y="409" width="47" height="20" fill="#D9D9D9" id="M08T05L55" class="area" title="M08T05L55"/>
<rect x="411" y="384" width="48" height="20" fill="#D9D9D9" id="M08T02L06" class="area" title="M08T02L06"/>
<rect x="461" y="384" width="49" height="20" fill="#D9D9D9" id="M08T02L16" class="area" title="M08T02L16"/>
<rect x="512" y="384" width="47" height="20" fill="#D9D9D9" id="M08T04L26" class="area" title="M08T04L26"/>
<rect x="411" y="362" width="48" height="20" fill="#D9D9D9" id="M08T02L07" class="area" title="M08T02L07"/>
<rect x="461" y="362" width="49" height="20" fill="#D9D9D9" id="M08T02L17" class="area" title="M08T02L17"/>
<rect x="512" y="362" width="47" height="20" fill="#D9D9D9" id="M08T04L27" class="area" title="M08T04L27"/>
<rect x="411" y="340" width="48" height="20" fill="#D9D9D9" id="M08T02L08" class="area" title="M08T02L08"/>
<rect x="461" y="340" width="49" height="20" fill="#D9D9D9" id="M08T02L18" class="area" title="M08T02L18"/>
<rect x="512" y="340" width="47" height="20" fill="#D9D9D9" id="M08T04L28" class="area" title="M08T04L28"/>
<rect x="411" y="318" width="48" height="20" fill="#D9D9D9" id="M08T02L09" class="area" title="M08T02L09"/>
<rect x="461" y="318" width="49" height="20" fill="#D9D9D9" id="M08T02L19" class="area" title="M08T02L19"/>
<rect x="512" y="318" width="47" height="20" fill="#D9D9D9" id="M08T04L29" class="area" title="M08T04L29"/>
<rect x="411" y="296" width="48" height="20" fill="#D9D9D9" id="M08T02L10" class="area" title="M08T02L10"/>
<rect x="461" y="296" width="49" height="20" fill="#D9D9D9" id="M08T02L20" class="area" title="M08T02L20"/>
<rect x="512" y="296" width="47" height="20" fill="#D9D9D9" id="M08T04L30" class="area" title="M08T04L30"/>
<rect x="565" y="384" width="48" height="20" fill="#D9D9D9" id="M08T04L36" class="area" title="M08T04L36"/>
<rect x="615" y="384" width="49" height="20" fill="#D9D9D9" id="M08T06L46" class="area" title="M08T06L46"/>
<rect x="666" y="384" width="47" height="20" fill="#D9D9D9" id="M08T06L56" class="area" title="M08T06L56"/>
<rect x="565" y="362" width="48" height="20" fill="#D9D9D9" id="M08T04L37" class="area" title="M08T04L37"/>
<rect x="615" y="362" width="49" height="20" fill="#D9D9D9" id="M08T06L47" class="area" title="M08T06L47"/>
<rect x="666" y="362" width="47" height="20" fill="#D9D9D9" id="M08T06L57" class="area" title="M08T06L57"/>
<rect x="565" y="340" width="48" height="20" fill="#D9D9D9" id="M08T04L38" class="area" title="M08T04L38"/>
<rect x="615" y="340" width="49" height="20" fill="#D9D9D9" id="M08T06L48" class="area" title="M08T06L48"/>
<rect x="666" y="340" width="47" height="20" fill="#D9D9D9" id="M08T06L58" class="area" title="M08T06L58"/>
<rect x="565" y="318" width="48" height="20" fill="#D9D9D9" id="M08T04L39" class="area" title="M08T04L39"/>
<rect x="615" y="318" width="49" height="20" fill="#D9D9D9" id="M08T06L49" class="area" title="M08T06L49"/>
<rect x="666" y="318" width="47" height="20" fill="#D9D9D9" id="M08T06L59" class="area" title="M08T06L59"/>
<rect x="565" y="296" width="48" height="20" fill="#D9D9D9" id="M08T04L40" class="area" title="M08T04L40"/>
<rect x="615" y="296" width="49" height="20" fill="#D9D9D9" id="M08T06L50" class="area" title="M08T06L50"/>
<rect x="666" y="296" width="47" height="20" fill="#D9D9D9" id="M08T06L60" class="area" title="M08T06L60"/>
<rect x="411" y="726" width="48" height="20" fill="#D9D9D9" id="M06T01L01" class="area" title="M06T01L01"/>
<rect x="461" y="726" width="49" height="20" fill="#D9D9D9" id="M06T01L08" class="area" title="M06T01L08"/>
<rect x="512" y="726" width="47" height="20" fill="#D9D9D9" id="M06T03L15" class="area" title="M06T03L15"/>
<rect x="411" y="704" width="48" height="20" fill="#D9D9D9" id="M06T01L02" class="area" title="M06T01L02"/>
<rect x="461" y="704" width="49" height="20" fill="#D9D9D9" id="M06T01L09" class="area" title="M06T01L09"/>
<rect x="512" y="704" width="47" height="20" fill="#D9D9D9" id="M06T03L16" class="area" title="M06T03L16"/>
<rect x="411" y="682" width="48" height="20" fill="#D9D9D9" id="M06T01L03" class="area" title="M06T01L03"/>
<rect x="461" y="682" width="49" height="20" fill="#D9D9D9" id="M06T01L10" class="area" title="M06T01L10"/>
<rect x="512" y="682" width="47" height="20" fill="#D9D9D9" id="M06T03L17" class="area" title="M06T03L17"/>
<rect x="411" y="660" width="48" height="20" fill="#D9D9D9" id="M06T01L04" class="area" title="M06T01L04"/>
<rect x="461" y="660" width="49" height="20" fill="#D9D9D9" id="M06T01L11" class="area" title="M06T01L11"/>
<rect x="512" y="660" width="47" height="20" fill="#D9D9D9" id="M06T03L18" class="area" title="M06T03L18"/>
<rect x="411" y="638" width="48" height="20" fill="#D9D9D9" id="M06T02L05" class="area" title="M06T02L05"/>
<rect x="461" y="638" width="49" height="20" fill="#D9D9D9" id="M06T02L12" class="area" title="M06T02L12"/>
<rect x="512" y="638" width="47" height="20" fill="#D9D9D9" id="M06T02L19" class="area" title="M06T02L19"/>
<rect x="565" y="726" width="48" height="20" fill="#D9D9D9" id="M06T03L22" class="area" title="M06T03L22"/>
<rect x="615" y="726" width="49" height="20" fill="#D9D9D9" id="M06T04L32" class="area" title="M06T04L32"/>
<rect x="666" y="726" width="47" height="20" fill="#D9D9D9" id="M06T04L42" class="area" title="M06T04L42"/>
<rect x="565" y="704" width="48" height="20" fill="#D9D9D9" id="M06T03L23" class="area" title="M06T03L23"/>
<rect x="615" y="704" width="49" height="20" fill="#D9D9D9" id="M06T04L33" class="area" title="M06T04L33"/>
<rect x="666" y="704" width="47" height="20" fill="#D9D9D9" id="M06T04L43" class="area" title="M06T04L43"/>
<rect x="565" y="682" width="48" height="20" fill="#D9D9D9" id="M06T03L24" class="area" title="M06T03L24"/>
<rect x="615" y="682" width="49" height="20" fill="#D9D9D9" id="M06T04L34" class="area" title="M06T04L34"/>
<rect x="666" y="682" width="47" height="20" fill="#D9D9D9" id="M06T04L44" class="area" title="M06T04L44"/>
<rect x="565" y="660" width="48" height="20" fill="#D9D9D9" id="M06T03L25" class="area" title="M06T03L25"/>
<rect x="615" y="660" width="49" height="20" fill="#D9D9D9" id="M06T04L35" class="area" title="M06T04L35"/>
<rect x="666" y="660" width="47" height="20" fill="#D9D9D9" id="M06T04L45" class="area" title="M06T04L45"/>
<rect x="565" y="638" width="48" height="20" fill="#D9D9D9" id="M06T05L26" class="area" title="M06T05L26"/>
<rect x="615" y="638" width="49" height="20" fill="#D9D9D9" id="M06T05L36" class="area" title="M06T05L36"/>
<rect x="666" y="638" width="47" height="20" fill="#D9D9D9" id="M06T05L46" class="area" title="M06T05L46"/>
<rect x="411" y="613" width="48" height="20" fill="#D9D9D9" id="M06T02L06" class="area" title="M06T02L06"/>
<rect x="461" y="613" width="49" height="20" fill="#D9D9D9" id="M06T02L13" class="area" title="M06T02L13"/>
<rect x="512" y="613" width="47" height="20" fill="#D9D9D9" id="M06T02L20" class="area" title="M06T02L20"/>
<rect x="411" y="591" width="48" height="20" fill="#D9D9D9" id="M06T02L07" class="area" title="M06T02L07"/>
<rect x="461" y="591" width="49" height="20" fill="#D9D9D9" id="M06T02L14" class="area" title="M06T02L14"/>
<rect x="512" y="591" width="47" height="20" fill="#D9D9D9" id="M06T02L21" class="area" title="M06T02L21"/>
<rect x="565" y="613" width="48" height="20" fill="#D9D9D9" id="M06T05L27" class="area" title="M06T05L27"/>
<rect x="615" y="613" width="49" height="20" fill="#D9D9D9" id="M06T05L37" class="area" title="M06T05L37"/>
<rect x="666" y="613" width="47" height="20" fill="#D9D9D9" id="M06T05L47" class="area" title="M06T05L47"/>
<rect x="565" y="591" width="48" height="20" fill="#D9D9D9" id="M06T05L28" class="area" title="M06T05L28"/>
<rect x="615" y="591" width="49" height="20" fill="#D9D9D9" id="M06T05L38" class="area" title="M06T05L38"/>
<rect x="666" y="591" width="47" height="20" fill="#D9D9D9" id="M06T05L48" class="area" title="M06T05L48"/>
<rect x="565" y="569" width="48" height="20" fill="#D9D9D9" id="M06T06L29" class="area" title="M06T06L29"/>
<rect x="615" y="569" width="49" height="20" fill="#D9D9D9" id="M06T06L39" class="area" title="M06T06L39"/>
<rect x="666" y="569" width="47" height="20" fill="#D9D9D9" id="M06T06L49" class="area" title="M06T06L49"/>
<rect x="565" y="547" width="48" height="20" fill="#D9D9D9" id="M06T06L30" class="area" title="M06T06L30"/>
<rect x="615" y="547" width="49" height="20" fill="#D9D9D9" id="M06T06L40" class="area" title="M06T06L40"/>
<rect x="666" y="547" width="47" height="20" fill="#D9D9D9" id="M06T06L50" class="area" title="M06T06L50"/>
<rect x="565" y="525" width="48" height="20" fill="#D9D9D9" id="M06T06L31" class="area" title="M06T06L31"/>
<rect x="615" y="525" width="49" height="20" fill="#D9D9D9" id="M06T06L41" class="area" title="M06T06L41"/>
<rect x="666" y="525" width="47" height="20" fill="#D9D9D9" id="M06T06L51" class="area" title="M06T06L51"/>
<rect x="411" y="955" width="48" height="20" fill="#D9D9D9" id="M04T01L01" class="area" title="M04T01L01"/>
<rect x="461" y="955" width="49" height="20" fill="#D9D9D9" id="M04T01L11" class="area" title="M04T01L11"/>
<rect x="512" y="955" width="47" height="20" fill="#D9D9D9" id="M04T03L21" class="area" title="M04T03L21"/>
<rect x="411" y="933" width="48" height="20" fill="#D9D9D9" id="M04T01L02" class="area" title="M04T01L02"/>
<rect x="461" y="933" width="49" height="20" fill="#D9D9D9" id="M04T01L12" class="area" title="M04T01L12"/>
<rect x="512" y="933" width="47" height="20" fill="#D9D9D9" id="M04T03L22" class="area" title="M04T03L22"/>
<rect x="411" y="911" width="48" height="20" fill="#D9D9D9" id="M04T01L03" class="area" title="M04T01L03"/>
<rect x="461" y="911" width="49" height="20" fill="#D9D9D9" id="M04T01L13" class="area" title="M04T01L13"/>
<rect x="512" y="911" width="47" height="20" fill="#D9D9D9" id="M04T03L23" class="area" title="M04T03L23"/>
<rect x="411" y="889" width="48" height="20" fill="#D9D9D9" id="M04T01L04" class="area" title="M04T01L04"/>
<rect x="461" y="889" width="49" height="20" fill="#D9D9D9" id="M04T01L14" class="area" title="M04T01L14"/>
<rect x="512" y="889" width="47" height="20" fill="#D9D9D9" id="M04T03L24" class="area" title="M04T03L24"/>
<rect x="411" y="867" width="48" height="20" fill="#D9D9D9" id="M04T01L05" class="area" title="M04T01L05"/>
<rect x="461" y="867" width="49" height="20" fill="#D9D9D9" id="M04T01L15" class="area" title="M04T01L15"/>
<rect x="512" y="867" width="47" height="20" fill="#D9D9D9" id="M04T03L25" class="area" title="M04T03L25"/>
<rect x="565" y="955" width="48" height="20" fill="#D9D9D9" id="M04T03L31" class="area" title="M04T03L31"/>
<rect x="615" y="955" width="49" height="20" fill="#D9D9D9" id="M04T05L41" class="area" title="M04T05L41"/>
<rect x="666" y="955" width="47" height="20" fill="#D9D9D9" id="M04T05L51" class="area" title="M04T05L51"/>
<rect x="565" y="933" width="48" height="20" fill="#D9D9D9" id="M04T03L32" class="area" title="M04T03L32"/>
<rect x="615" y="933" width="49" height="20" fill="#D9D9D9" id="M04T05L42" class="area" title="M04T05L42"/>
<rect x="666" y="933" width="47" height="20" fill="#D9D9D9" id="M04T05L52" class="area" title="M04T05L52"/>
<rect x="565" y="911" width="48" height="20" fill="#D9D9D9" id="M04T03L33" class="area" title="M04T03L33"/>
<rect x="615" y="911" width="49" height="20" fill="#D9D9D9" id="M04T05L43" class="area" title="M04T05L43"/>
<rect x="666" y="911" width="47" height="20" fill="#D9D9D9" id="M04T05L53" class="area" title="M04T05L53"/>
<rect x="565" y="889" width="48" height="20" fill="#D9D9D9" id="M04T03L34" class="area" title="M04T03L34"/>
<rect x="615" y="889" width="49" height="20" fill="#D9D9D9" id="M04T05L44" class="area" title="M04T05L44"/>
<rect x="666" y="889" width="47" height="20" fill="#D9D9D9" id="M04T05L54" class="area" title="M04T05L54"/>
<rect x="565" y="867" width="48" height="20" fill="#D9D9D9" id="M04T03L35" class="area" title="M04T03L35"/>
<rect x="615" y="867" width="49" height="20" fill="#D9D9D9" id="M04T05L45" class="area" title="M04T05L45"/>
<rect x="666" y="867" width="47" height="20" fill="#D9D9D9" id="M04T05L55" class="area" title="M04T05L55"/>
<rect x="411" y="842" width="48" height="20" fill="#D9D9D9" id="M04T02L06" class="area" title="M04T02L06"/>
<rect x="461" y="842" width="49" height="20" fill="#D9D9D9" id="M04T02L16" class="area" title="M04T02L16"/>
<rect x="512" y="842" width="47" height="20" fill="#D9D9D9" id="M04T04L26" class="area" title="M04T04L26"/>
<rect x="411" y="820" width="48" height="20" fill="#D9D9D9" id="M04T02L07" class="area" title="M04T02L07"/>
<rect x="461" y="820" width="49" height="20" fill="#D9D9D9" id="M04T02L17" class="area" title="M04T02L17"/>
<rect x="512" y="820" width="47" height="20" fill="#D9D9D9" id="M04T04L27" class="area" title="M04T04L27"/>
<rect x="411" y="798" width="48" height="20" fill="#D9D9D9" id="M04T02L08" class="area" title="M04T02L08"/>
<rect x="461" y="798" width="49" height="20" fill="#D9D9D9" id="M04T02L18" class="area" title="M04T02L18"/>
<rect x="512" y="798" width="47" height="20" fill="#D9D9D9" id="M04T04L28" class="area" title="M04T04L28"/>
<rect x="411" y="776" width="48" height="20" fill="#D9D9D9" id="M04T02L09" class="area" title="M04T02L09"/>
<rect x="461" y="776" width="49" height="20" fill="#D9D9D9" id="M04T02L19" class="area" title="M04T02L19"/>
<rect x="512" y="776" width="47" height="20" fill="#D9D9D9" id="M04T04L29" class="area" title="M04T04L29"/>
<rect x="411" y="754" width="48" height="20" fill="#D9D9D9" id="M04T02L10" class="area" title="M04T02L10"/>
<rect x="461" y="754" width="49" height="20" fill="#D9D9D9" id="M04T02L20" class="area" title="M04T02L20"/>
<rect x="512" y="754" width="47" height="20" fill="#D9D9D9" id="M04T04L30" class="area" title="M04T04L30"/>
<rect x="565" y="842" width="48" height="20" fill="#D9D9D9" id="M04T04L36" class="area" title="M04T04L36"/>
<rect x="615" y="842" width="49" height="20" fill="#D9D9D9" id="M04T06L46" class="area" title="M04T06L46"/>
<rect x="666" y="842" width="47" height="20" fill="#D9D9D9" id="M04T06L56" class="area" title="M04T06L56"/>
<rect x="727" y="889" width="7" height="10" fill="#D9D9D9" id="RECT_431" class="area" title=""/>
<rect x="729" y="903" width="10" height="12" fill="#D9D9D9" id="RECT_432" class="area" title=""/>
<rect x="565" y="820" width="48" height="20" fill="#D9D9D9" id="M04T04L37" class="area" title="M04T04L37"/>
<rect x="615" y="820" width="49" height="20" fill="#D9D9D9" id="M04T06L47" class="area" title="M04T06L47"/>
<rect x="666" y="820" width="47" height="20" fill="#D9D9D9" id="M04T06L57" class="area" title="M04T06L57"/>
<rect x="565" y="798" width="48" height="20" fill="#D9D9D9" id="M04T04L38" class="area" title="M04T04L38"/>
<rect x="615" y="798" width="49" height="20" fill="#D9D9D9" id="M04T06L48" class="area" title="M04T06L48"/>
<rect x="666" y="798" width="47" height="20" fill="#D9D9D9" id="M04T06L58" class="area" title="M04T06L58"/>
<rect x="565" y="776" width="48" height="20" fill="#D9D9D9" id="M04T04L39" class="area" title="M04T04L39"/>
<rect x="615" y="776" width="49" height="20" fill="#D9D9D9" id="M04T06L49" class="area" title="M04T06L49"/>
<rect x="666" y="776" width="47" height="20" fill="#D9D9D9" id="M04T06L59" class="area" title="M04T06L59"/>
<rect x="565" y="754" width="48" height="20" fill="#D9D9D9" id="M04T04L40" class="area" title="M04T04L40"/>
<rect x="615" y="754" width="49" height="20" fill="#D9D9D9" id="M04T06L50" class="area" title="M04T06L50"/>
<rect x="666" y="754" width="47" height="20" fill="#D9D9D9" id="M04T06L60" class="area" title="M04T06L60"/>
<rect x="411" y="1184" width="48" height="20" fill="#D9D9D9" id="M02T01L01" class="area" title="M02T01L01"/>
<rect x="461" y="1184" width="49" height="20" fill="#D9D9D9" id="M02T01L09" class="area" title="M02T01L09"/>
<rect x="512" y="1184" width="47" height="20" fill="#D9D9D9" id="M02T03L17" class="area" title="M02T03L17"/>
<rect x="411" y="1162" width="48" height="20" fill="#D9D9D9" id="M02T01L02" class="area" title="M02T01L02"/>
<rect x="461" y="1162" width="49" height="20" fill="#D9D9D9" id="M02T01L10" class="area" title="M02T01L10"/>
<rect x="512" y="1162" width="47" height="20" fill="#D9D9D9" id="M02T03L18" class="area" title="M02T03L18"/>
<rect x="411" y="1140" width="48" height="20" fill="#D9D9D9" id="M02T01L03" class="area" title="M02T01L03"/>
<rect x="461" y="1140" width="49" height="20" fill="#D9D9D9" id="M02T01L11" class="area" title="M02T01L11"/>
<rect x="512" y="1140" width="47" height="20" fill="#D9D9D9" id="M02T03L19" class="area" title="M02T03L19"/>
<rect x="411" y="1118" width="48" height="20" fill="#D9D9D9" id="M02T01L04" class="area" title="M02T01L04"/>
<rect x="461" y="1118" width="49" height="20" fill="#D9D9D9" id="M02T01L12" class="area" title="M02T01L12"/>
<rect x="512" y="1118" width="47" height="20" fill="#D9D9D9" id="M02T03L20" class="area" title="M02T03L20"/>
<rect x="411" y="1096" width="48" height="20" fill="#D9D9D9" id="M02T02L05" class="area" title="M02T02L05"/>
<rect x="461" y="1096" width="49" height="20" fill="#D9D9D9" id="M02T02L13" class="area" title="M02T02L13"/>
<rect x="512" y="1096" width="47" height="20" fill="#D9D9D9" id="M02T03L21" class="area" title="M02T03L21"/>
<rect x="565" y="1184" width="48" height="20" fill="#D9D9D9" id="M02T03L27" class="area" title="M02T03L27"/>
<rect x="615" y="1184" width="49" height="20" fill="#D9D9D9" id="M02T05L37" class="area" title="M02T05L37"/>
<path d="M666 1184H693L689 1204H666V1184Z" fill="#D9D9D9" id="M02T05L47" class="area" title="M02T05L47"/>
<rect x="565" y="1162" width="48" height="20" fill="#D9D9D9" id="M02T03L28" class="area" title="M02T03L28"/>
<rect x="615" y="1162" width="49" height="20" fill="#D9D9D9" id="M02T05L38" class="area" title="M02T05L38"/>
<path d="M666 1162H698L693 1182H666V1162Z" fill="#D9D9D9" id="M02T05L48" class="area" title="M02T05L48"/>
<rect x="565" y="1140" width="48" height="20" fill="#D9D9D9" id="M02T03L29" class="area" title="M02T03L29"/>
<rect x="615" y="1140" width="49" height="20" fill="#D9D9D9" id="M02T05L39" class="area" title="M02T05L39"/>
<path d="M666 1140H703L698 1160H666V1140Z" fill="#D9D9D9" id="M02T05L49" class="area" title="M02T05L49"/>
<rect x="565" y="1118" width="48" height="20" fill="#D9D9D9" id="M02T03L30" class="area" title="M02T03L30"/>
<rect x="615" y="1118" width="49" height="20" fill="#D9D9D9" id="M02T05L40" class="area" title="M02T05L40"/>
<path d="M666 1118H708L703 1138H666V1118Z" fill="#D9D9D9" id="M02T05L50" class="area" title="M02T05L50"/>
<rect x="565" y="1096" width="48" height="20" fill="#D9D9D9" id="M02T03L31" class="area" title="M02T03L31"/>
<rect x="615" y="1096" width="49" height="20" fill="#D9D9D9" id="M02T05L41" class="area" title="M02T05L41"/>
<rect x="411" y="1071" width="48" height="20" fill="#D9D9D9" id="M02T02L06" class="area" title="M02T02L06"/>
<rect x="461" y="1071" width="49" height="20" fill="#D9D9D9" id="M02T02L14" class="area" title="M02T02L14"/>
<rect x="512" y="1071" width="47" height="20" fill="#D9D9D9" id="M02T04L22" class="area" title="M02T04L22"/>
<rect x="411" y="1049" width="48" height="20" fill="#D9D9D9" id="M02T02L07" class="area" title="M02T02L07"/>
<rect x="461" y="1049" width="49" height="20" fill="#D9D9D9" id="M02T02L15" class="area" title="M02T02L15"/>
<rect x="512" y="1049" width="47" height="20" fill="#D9D9D9" id="M02T04L23" class="area" title="M02T04L23"/>
<rect x="411" y="1027" width="48" height="20" fill="#D9D9D9" id="M02T02L08" class="area" title="M02T02L08"/>
<rect x="461" y="1027" width="49" height="20" fill="#D9D9D9" id="M02T02L16" class="area" title="M02T02L16"/>
<rect x="512" y="1027" width="47" height="20" fill="#D9D9D9" id="M02T04L24" class="area" title="M02T04L24"/>
<rect x="539" y="1005" width="20" height="20" fill="#D9D9D9" id="M02T04L25" class="area" title="M02T04L25"/>
<rect x="539" y="983" width="20" height="20" fill="#D9D9D9" id="M02T04L26" class="area" title="M02T04L26"/>
<rect x="565" y="1071" width="48" height="20" fill="#D9D9D9" id="M02T04L32" class="area" title="M02T04L32"/>
<rect x="615" y="1071" width="49" height="20" fill="#D9D9D9" id="M02T06L42" class="area" title="M02T06L42"/>
<rect x="666" y="1071" width="47" height="20" fill="#D9D9D9" id="M02T06L52" class="area" title="M02T06L52"/>
<rect x="565" y="1049" width="48" height="20" fill="#D9D9D9" id="M02T04L33" class="area" title="M02T04L33"/>
<rect x="615" y="1049" width="49" height="20" fill="#D9D9D9" id="M02T06L43" class="area" title="M02T06L43"/>
<rect x="666" y="1049" width="47" height="20" fill="#D9D9D9" id="M02T06L53" class="area" title="M02T06L53"/>
<rect x="565" y="1027" width="48" height="20" fill="#D9D9D9" id="M02T04L34" class="area" title="M02T04L34"/>
<rect x="615" y="1027" width="49" height="20" fill="#D9D9D9" id="M02T06L44" class="area" title="M02T06L44"/>
<rect x="666" y="1027" width="47" height="20" fill="#D9D9D9" id="M02T06L54" class="area" title="M02T06L54"/>
<rect x="565" y="1005" width="48" height="20" fill="#D9D9D9" id="M02T04L35" class="area" title="M02T04L35"/>
<rect x="615" y="1005" width="49" height="20" fill="#D9D9D9" id="M02T06L45" class="area" title="M02T06L45"/>
<rect x="666" y="1005" width="47" height="20" fill="#D9D9D9" id="M02T06L55" class="area" title="M02T06L55"/>
<rect x="565" y="983" width="48" height="20" fill="#D9D9D9" id="M02T04L36" class="area" title="M02T04L36"/>
<rect x="615" y="983" width="49" height="20" fill="#D9D9D9" id="M02T06L46" class="area" title="M02T06L46"/>
<rect x="666" y="983" width="47" height="20" fill="#D9D9D9" id="M02T06L56" class="area" title="M02T06L56"/>
<path d="M666 1096H713L708 1116H666V1096Z" fill="#D9D9D9" id="M02T05L51" class="area" title="M02T05L51"/>
</svg>
  <div class="tooltip" id="polygon-tooltip"></div>
</div>

<form id="form-aplicacion">
  <button onclick="enviarDatos()">Enviar datos</button>  
  <div class="form-group">
    <label for="producto">Productos:</label>
    <select id="producto" multiple size="4">
      <option value="" disabled>Cargando productos...</option>
    </select>
  </div>
  
  <div class="form-group">
    <label for="fechas">Fechas de aplicación:</label>
    <input type="text" id="fechas" placeholder="Selecciona fechas">
  </div>
  
  <div class="form-group">
    <label for="color-picker">Color del área:</label>
    <input type="color" id="color-picker" value="#f1042f">
  </div>


<div id="selected-areas">
  <h3>Áreas seleccionadas:</h3>
  <ul id="selected-list"></ul>
</div>
</form>

</main>
<script>
  // Inicializar flatpickr
  flatpickr("#fechas", {
    mode: "multiple",
    dateFormat: "Y-m-d",
    locale: "es"
  });

  const selectedAreas = new Map(); // Almacena id y color
  let currentColor = "#f1042f";
  const colorPicker = document.getElementById("color-picker");
  const selectedList = document.getElementById("selected-list");
  const tooltip = document.getElementById("polygon-tooltip");

  // Función para cargar productos desde Google Sheets
  async function cargarProductos() {
    try {
      const response = await fetch('https://script.google.com/macros/s/AKfycbwVmi6nlKhZ8OcyCjA-Mp_UBnVMla0iCx4rrJ4yRMzWEPh6ZtEfSmw0W1IWD7P5iA5Q9g/exec?action=getProducts');
      const productos = await response.json();
      
      const select = document.getElementById('producto');
      select.innerHTML = '';
      
      if (productos.length === 0) {
        select.innerHTML = '<option value="" disabled>No hay productos disponibles</option>';
        return;
      }
      
      productos.forEach(producto => {
        const option = document.createElement('option');
        option.value = producto;
        option.textContent = producto;
        select.appendChild(option);
      });
      
      // Añadir placeholder cuando no hay selección
      select.multiple = true;
      select.size = 4;
      
    } catch (error) {
      console.error("Error al cargar productos:", error);
      // Opción de respaldo si falla la carga
      const select = document.getElementById('producto');
      select.innerHTML = `
                <option value="ABSOLUTE 60 SC">ABSOLUTE 60 SC</option>
<option value="ACTARA">ACTARA</option>
<option value="ACTIFILM">ACTIFILM</option>
<option value="ADMIRAL">ADMIRAL</option>
<option value="AGRIKELP G">AGRIKELP G</option>
<option value="ALGA PLEX">ALGA PLEX</option>
<option value="ALGASIL">ALGASIL</option>
<option value="ASPIRE">ASPIRE</option>
<option value="AZOXYSTROBIN 50">AZOXYSTROBIN 50</option>
<option value="BAMECTIN">BAMECTIN</option>
<option value="BARRERA">BARRERA</option>
<option value="BASFOLIAR KELP">BASFOLIAR KELP</option>
<option value="BEAUVESOL">BEAUVESOL</option>
<option value="BELLIS">BELLIS</option>
<option value="BIOCINN">BIOCINN</option>
<option value="BIOKARANYA">BIOKARANYA</option>
<option value="BIOSPORE">BIOSPORE</option>
<option value="BIOTEX">BIOTEX</option>
<option value="BIOXTER">BIOXTER</option>
<option value="BREAK THRU">BREAK THRU</option>
<option value="BTK CROPS">BTK CROPS</option>
<option value="CANELIS">CANELIS</option>
<option value="CAPEMIL">CAPEMIL</option>
<option value="CHEKKER">CHEKKER</option>
<option value="CLORFOS">CLORFOS</option>
<option value="CONTRINO">CONTRINO</option>
<option value="CORAGEN SC">CORAGEN SC</option>
<option value="CROPS-CANELA">CROPS-CANELA</option>
<option value="CYFLUNIL">CYFLUNIL</option>
<option value="DIAMOND 60 EC">DIAMOND 60 EC</option>
<option value="DORMEX">DORMEX</option>
<option value="ENTRUST SC">ENTRUST SC</option>
<option value="ESFINGE">ESFINGE</option>
<option value="FITOMARE">FITOMARE</option>
<option value="FLEXITY">FLEXITY</option>
<option value="FOLIGUARD SC">FOLIGUARD SC</option>
<option value="FORZASIL">FORZASIL</option>
<option value="FROTHER">FROTHER</option>
<option value="FUNGISEI">FUNGISEI</option>
<option value="GF 120">GF 120</option>
<option value="GLADIADOR">GLADIADOR</option>
<option value="GLUCOMAN">GLUCOMAN</option>
<option value="GLUTAPRO">GLUTAPRO</option>
<option value="GOLDEN NATURAL">GOLDEN NATURAL</option>
<option value="GRANDEVO WG">GRANDEVO WG</option>
<option value="GRENEX ULTRA">GRENEX ULTRA</option>
<option value="HURAKAN">HURAKAN</option>
<option value="HURRICANE">HURRICANE</option>
<option value="INBIO CINAMMO">INBIO CINAMMO</option>
<option value="IRONMAN 72EC">IRONMAN 72EC</option>
<option value="JAMBO">JAMBO</option>
<option value="KALIGREEN">KALIGREEN</option>
<option value="KELIK K">KELIK K</option>
<option value="KIETO 150 WG">KIETO 150 WG</option>
<option value="K-NELAZO">K-NELAZO</option>
<option value="L-ESPECIALISTA">L-ESPECIALISTA</option>
<option value="MAMULL">MAMULL</option>
<option value="MERIDIAN">MERIDIAN</option>
<option value="METHOMYL">METHOMYL</option>
<option value="MONSAIBIO">MONSAIBIO</option>
<option value="NATIVO">NATIVO</option>
<option value="NEXUS 50 SL">NEXUS 50 SL</option>
<option value="NO"MINADOR">NO"MINADOR</option>
<option value="NUTRIWET">NUTRIWET</option>
<option value="ORBITT">ORBITT</option>
<option value="ORIUS 430 SC">ORIUS 430 SC</option>
<option value="PANTERA 720">PANTERA 720</option>
<option value="PANTERA PROCESA">PANTERA PROCESA</option>
<option value="PHYLGREEN">PHYLGREEN</option>
<option value="PICNEAT 100 EC">PICNEAT 100 EC</option>
<option value="PROTEXASOL 360">PROTEXASOL 360</option>
<option value="QUILLIBRIUM">QUILLIBRIUM</option>
<option value="ROOT-HOR">ROOT-HOR</option>
<option value="SCORE 250 SC">SCORE 250 SC</option>
<option value="SEGURITE 625 WG">SEGURITE 625 WG</option>
<option value="SPLINTER">SPLINTER</option>
<option value="STIMPLEX">STIMPLEX</option>
<option value="STRACTA">STRACTA</option>
<option value="SULFA 87">SULFA 87</option>
<option value="SUPRIMER 50 WG">SUPRIMER 50 WG</option>
<option value="SURROUND WP">SURROUND WP</option>
<option value="SWITCH 62.5 WG">SWITCH 62.5 WG</option>
<option value="T - REX">T - REX</option>
<option value="TENSAPLLY">TENSAPLLY</option>
<option value="TIMOREX GOLD">TIMOREX GOLD</option>
<option value="ULTRAFERRO">ULTRAFERRO</option>
<option value="URTICOL">URTICOL</option>
<option value="VAPOR GARD">VAPOR GARD</option>
<option value="VICTOZA">VICTOZA</option>
<option value="WITNEMA">WITNEMA</option>
      `;
      select.multiple = true;
      select.size = 4;
    }
  }

  // Configurar tooltips y selección de áreas
  document.querySelectorAll("svg .area").forEach(area => {
    // Tooltip
    area.addEventListener("mouseover", function(e) {
      tooltip.textContent = `Área: ${this.id}`;
      tooltip.style.display = 'block';
      
      const rect = this.getBoundingClientRect();
      tooltip.style.left = `${rect.left + window.scrollX}px`;
      tooltip.style.top = `${rect.top + window.scrollY - 30}px`;
    });
    
    area.addEventListener("mouseout", function() {
      tooltip.style.display = 'none';
    });
    
    area.addEventListener("mousemove", function(e) {
      tooltip.style.left = `${e.pageX + 10}px`;
      tooltip.style.top = `${e.pageY + 10}px`;
    });
    
    // Selección de área
    area.addEventListener("click", () => {
      const id = area.id;
      
      if (selectedAreas.has(id)) {
        // Deseleccionar
        selectedAreas.delete(id);
        area.classList.remove("selected");
        area.removeAttribute("data-custom-color");
        area.style.fill = "";
      } else {
        // Seleccionar con color actual
        selectedAreas.set(id, currentColor);
        area.classList.add("selected");
        area.setAttribute("data-custom-color", currentColor);
        area.style.fill = currentColor;
      }
      
      updateSelectedList();
    });
  });

  // Cambiar color actual
  colorPicker.addEventListener("input", function() {
    currentColor = this.value;
    
    // Aplicar nuevo color a áreas seleccionadas
    selectedAreas.forEach((color, id) => {
      selectedAreas.set(id, currentColor);
      const area = document.getElementById(id);
      if (area) {
        area.style.fill = currentColor;
        area.setAttribute("data-custom-color", currentColor);
      }
    });
    
    updateSelectedList();
  });

  // Actualizar lista de áreas seleccionadas
  function updateSelectedList() {
    selectedList.innerHTML = '';
    
    selectedAreas.forEach((color, id) => {
      const li = document.createElement('li');
      li.innerHTML = `
        <span>${id}</span>
        <div>
          <input type="color" value="${color}" class="item-color" data-id="${id}" style="width: 20px; height: 20px; vertical-align: middle;">
          <span class="remove-area" data-id="${id}">✖</span>
        </div>
      `;
      selectedList.appendChild(li);
    });
    
    // Eventos para cambiar colores individuales
    document.querySelectorAll('.item-color').forEach(input => {
      input.addEventListener('change', function() {
        const id = this.getAttribute('data-id');
        const newColor = this.value;
        selectedAreas.set(id, newColor);
        
        const area = document.getElementById(id);
        if (area) {
          area.style.fill = newColor;
          area.setAttribute('data-custom-color', newColor);
        }
      });
    });
    
    // Eventos para eliminar áreas
    document.querySelectorAll('.remove-area').forEach(span => {
      span.addEventListener('click', function() {
        const id = this.getAttribute('data-id');
        selectedAreas.delete(id);
        
        const area = document.getElementById(id);
        if (area) {
          area.classList.remove("selected");
          area.removeAttribute("data-custom-color");
          area.style.fill = "";
        }
        
        updateSelectedList();
      });
    });
  }

  async function enviarDatos() {
    const btn = document.querySelector('button');
    const originalText = btn.textContent;
    
    try {
      btn.disabled = true;
      btn.textContent = "Enviando...";
      
      // Obtener productos seleccionados (pueden ser múltiples)
      const productos = Array.from(document.getElementById("producto").selectedOptions)
                            .map(option => option.value)
                            .join(", "); // Concatenar con comas
      
      const fechas = document.getElementById("fechas").value.split(',').map(f => f.trim());
      
      if (!productos || fechas.length === 0 || selectedAreas.size === 0) {
        alert("Por favor, completa todos los campos y selecciona al menos un área.");
        return;
      }
      
      const areasArray = Array.from(selectedAreas.keys());
      const fechasFormateadas = fechas.map(fecha => {
        const [year, month, day] = fecha.split('-');
        return `${day}/${month}/${year}`;
      });

      const datos = {
        producto: productos,
        fechas: fechasFormateadas,
        areas: areasArray,
        fechaEnvio: new Date().toISOString()
      };
      
      await fetch('https://script.google.com/macros/s/AKfycbxcpenVMd4Vz56CLQ1TeIcD8vVUPc92bTbpb2T7aJOl-hqPKRv_ElNM896BLJZ_gns4/exec', {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(datos)
      });
      
      alert("Datos enviados correctamente.");
      
      // Limpiar selección
      selectedAreas.forEach((color, id) => {
        const area = document.getElementById(id);
        if (area) {
          area.classList.remove("selected");
          area.removeAttribute("data-custom-color");
          area.style.fill = "";
        }
      });
      selectedAreas.clear();
      updateSelectedList();
      document.getElementById("producto").selectedIndex = -1; // Deseleccionar todos
      document.getElementById("fechas").value = "";
      
    } catch (error) {
      alert("Error al enviar datos. Por favor, inténtalo de nuevo.");
      console.error(error);
    } finally {
      btn.disabled = false;
      btn.textContent = originalText;
    }
  }

  // Hacer el mapa responsive
  function adjustMapSize() {
    const container = document.getElementById('map-container');
    const svg = document.querySelector('svg');
    
    const containerWidth = container.offsetWidth;
    const aspectRatio = 1577 / 2274;
    
    svg.style.width = containerWidth + 'px';
    svg.style.height = (containerWidth / aspectRatio) + 'px';
  }
  
  // Inicialización
  document.addEventListener('DOMContentLoaded', () => {
    adjustMapSize();
    cargarProductos();
  });
  
  window.addEventListener('resize', adjustMapSize);
</script>

</body>
</html>
